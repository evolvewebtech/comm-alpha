/**
 * Isotope v1.5.19
 * An exquisite jQuery plugin for magical layouts
 * http://isotope.metafizzy.co
 *
 * Commercial use requires one-time license fee
 * http://metafizzy.co/#licenses
 *
 * Copyright 2012 David DeSandro / Metafizzy
 * 
 * MODIFICATO DA ALESSANDRO (1/7/2012)
 * 
 */
(function(a,b,c){"use strict";var d=a.document;var e=a.Modernizr;var f=function(a){return a.charAt(0).toUpperCase()+a.slice(1)};var g="Moz Webkit O Ms".split(" ");var h=function(a){var b=d.documentElement.style,c;if(typeof b[a]==="string"){return a}a=f(a);for(var e=0,h=g.length;e<h;e++){c=g[e]+a;if(typeof b[c]==="string"){return c}}};var i=h("transform"),j=h("transitionProperty");var k={csstransforms:function(){return!!i},csstransforms3d:function(){var a=!!h("perspective");if(a){var c=" -o- -moz- -ms- -webkit- -khtml- ".split(" "),d="@media ("+c.join("transform-3d),(")+"modernizr)",e=b("<style>"+d+"{#modernizr{height:3px}}"+"</style>").appendTo("head"),f=b('<div id="modernizr" />').appendTo("html");a=f.height()===3;f.remove();e.remove()}return a},csstransitions:function(){return!!j}};var l;if(e){for(l in k){if(!e.hasOwnProperty(l)){e.addTest(l,k[l])}}}else{e=a.Modernizr={_version:"1.6ish: miniModernizr for Isotope"};var m=" ";var n;for(l in k){n=k[l]();e[l]=n;m+=" "+(n?"":"no-")+l}b("html").addClass(m)}if(e.csstransforms){var o=e.csstransforms3d?{translate:function(a){return"translate3d("+a[0]+"px, "+a[1]+"px, 0) "},scale:function(a){return"scale3d("+a+", "+a+", 1) "}}:{translate:function(a){return"translate("+a[0]+"px, "+a[1]+"px) "},scale:function(a){return"scale("+a+") "}};var p=function(a,c,d){var e=b.data(a,"isoTransform")||{},f={},g,h={},j;f[c]=d;b.extend(e,f);for(g in e){j=e[g];h[g]=o[g](j)}var k=h.translate||"",l=h.scale||"",m=k+l;b.data(a,"isoTransform",e);a.style[i]=m};b.cssNumber.scale=true;b.cssHooks.scale={set:function(a,b){p(a,"scale",b)},get:function(a,c){var d=b.data(a,"isoTransform");return d&&d.scale?d.scale:1}};b.fx.step.scale=function(a){b.cssHooks.scale.set(a.elem,a.now+a.unit)};b.cssNumber.translate=true;b.cssHooks.translate={set:function(a,b){p(a,"translate",b)},get:function(a,c){var d=b.data(a,"isoTransform");return d&&d.translate?d.translate:[0,0]}}}var q,r;if(e.csstransitions){q={WebkitTransitionProperty:"webkitTransitionEnd",MozTransitionProperty:"transitionend",OTransitionProperty:"oTransitionEnd",transitionProperty:"transitionEnd"}[j];r=h("transitionDuration")}var s=b.event,t;s.special.smartresize={setup:function(){b(this).bind("resize",s.special.smartresize.handler)},teardown:function(){b(this).unbind("resize",s.special.smartresize.handler)},handler:function(a,b){var c=this,d=arguments;a.type="smartresize";if(t){clearTimeout(t)}t=setTimeout(function(){jQuery.event.handle.apply(c,d)},b==="execAsap"?0:100)}};b.fn.smartresize=function(a){return a?this.bind("smartresize",a):this.trigger("smartresize",["execAsap"])};b.Isotope=function(a,c,d){this.element=b(c);this._create(a);this._init(d)};var u=["width","height"];var v=b(a);b.Isotope.settings={resizable:true,layoutMode:"masonry",containerClass:"isotope",itemClass:"isotope-item",hiddenClass:"isotope-hidden",hiddenStyle:{opacity:0,scale:.001},visibleStyle:{opacity:1,scale:1},containerStyle:{position:"relative",overflow:"hidden"},animationEngine:"best-available",animationOptions:{queue:false,duration:800},sortBy:"original-order",sortAscending:true,resizesContainer:true,transformsEnabled:!b.browser.opera,itemPositionDataEnabled:false};b.Isotope.prototype={_create:function(a){this.options=b.extend({},b.Isotope.settings,a);this.styleQueue=[];this.elemCount=0;var c=this.element[0].style;this.originalStyle={};var d=u.slice(0);for(var e in this.options.containerStyle){d.push(e)}for(var f=0,g=d.length;f<g;f++){e=d[f];this.originalStyle[e]=c[e]||""}this.element.css(this.options.containerStyle);this._updateAnimationEngine();this._updateUsingTransforms();var h={"original-order":function(a,b){b.elemCount++;return b.elemCount},random:function(){return Math.random()}};this.options.getSortData=b.extend(this.options.getSortData,h);this.reloadItems();this.offset={left:parseInt(this.element.css("padding-left")||0,10),top:parseInt(this.element.css("padding-top")||0,10)};var i=this;setTimeout(function(){i.element.addClass(i.options.containerClass)},0);if(this.options.resizable){v.bind("smartresize.isotope",function(){i.resize()})}this.element.delegate("."+this.options.hiddenClass,"click",function(){return false})},_getAtoms:function(a){var b=this.options.itemSelector,c=b?a.filter(b).add(a.find(b)):a,d={position:"absolute"};if(this.usingTransforms){d.left=0;d.top=0}c.css(d).addClass(this.options.itemClass);this.updateSortData(c,true);return c},_init:function(a){this.$filteredAtoms=this._filter(this.$allAtoms);this._sort();this.reLayout(a)},option:function(a){if(b.isPlainObject(a)){this.options=b.extend(true,this.options,a);var c;for(var d in a){c="_update"+f(d);if(this[c]){this[c]()}}}},_updateAnimationEngine:function(){var a=this.options.animationEngine.toLowerCase().replace(/[ _\-]/g,"");var b;switch(a){case"css":case"none":b=false;break;case"jquery":b=true;break;default:b=!e.csstransitions}this.isUsingJQueryAnimation=b;this._updateUsingTransforms()},_updateTransformsEnabled:function(){this._updateUsingTransforms()},_updateUsingTransforms:function(){var a=this.usingTransforms=this.options.transformsEnabled&&e.csstransforms&&e.csstransitions&&!this.isUsingJQueryAnimation;if(!a){delete this.options.hiddenStyle.scale;delete this.options.visibleStyle.scale}this.getPositionStyles=a?this._translate:this._positionAbs},_filter:function(a){var b=this.options.filter===""?"*":this.options.filter;if(!b){return a}var c=this.options.hiddenClass,d="."+c,e=a.filter(d),f=e;if(b!=="*"){f=e.filter(b);var g=a.not(d).not(b).addClass(c);this.styleQueue.push({$el:g,style:this.options.hiddenStyle})}this.styleQueue.push({$el:f,style:this.options.visibleStyle});f.removeClass(c);return a.filter(b)},updateSortData:function(a,c){var d=this,e=this.options.getSortData,f,g;a.each(function(){f=b(this);g={};for(var a in e){if(!c&&a==="original-order"){g[a]=b.data(this,"isotope-sort-data")[a]}else{g[a]=e[a](f,d)}}b.data(this,"isotope-sort-data",g)})},_sort:function(){var a=this.options.sortBy,b=this._getSorter,c=this.options.sortAscending?1:-1,d=function(d,e){var f=b(d,a),g=b(e,a);if(f===g&&a!=="original-order"){f=b(d,"original-order");g=b(e,"original-order")}return(f>g?1:f<g?-1:0)*c};this.$filteredAtoms.sort(d)},_getSorter:function(a,c){return b.data(a,"isotope-sort-data")[c]},_translate:function(a,b){return{translate:[a,b]}},_positionAbs:function(a,b){return{left:a,top:b}},_pushPosition:function(a,b,c){b=Math.round(b+this.offset.left);c=Math.round(c+this.offset.top);var d=this.getPositionStyles(b,c);this.styleQueue.push({$el:a,style:d});if(this.options.itemPositionDataEnabled){a.data("isotope-item-position",{x:b,y:c})}},layout:function(a,b){var c=this.options.layoutMode;this["_"+c+"Layout"](a);if(this.options.resizesContainer){var d=this["_"+c+"GetContainerSize"]();this.styleQueue.push({$el:this.element,style:d})}this._processStyleQueue(a,b);this.isLaidOut=true},_processStyleQueue:function(a,c){var d=!this.isLaidOut?"css":this.isUsingJQueryAnimation?"animate":"css",f=this.options.animationOptions,g=this.options.onLayout,h,i,j,k;i=function(a,b){b.$el[d](b.style,f)};if(this._isInserting&&this.isUsingJQueryAnimation){i=function(a,b){h=b.$el.hasClass("no-transition")?"css":d;b.$el[h](b.style,f)}}else if(c||g||f.complete){var l=false,m=[c,g,f.complete],n=this;j=true;k=function(){if(l){return}var b;for(var c=0,d=m.length;c<d;c++){b=m[c];if(typeof b==="function"){b.call(n.element,a,n)}}l=true};if(this.isUsingJQueryAnimation&&d==="animate"){f.complete=k;j=false}else if(e.csstransitions){var o=0,p=this.styleQueue[0],s=p&&p.$el,t;while(!s||!s.length){t=this.styleQueue[o++];if(!t){return}s=t.$el}var u=parseFloat(getComputedStyle(s[0])[r]);if(u>0){i=function(a,b){b.$el[d](b.style,f).one(q,k)};j=false}}}b.each(this.styleQueue,i);if(j){k()}this.styleQueue=[]},resize:function(){if(this["_"+this.options.layoutMode+"ResizeChanged"]()){this.reLayout()}},reLayout:function(a){this["_"+this.options.layoutMode+"Reset"]();this.layout(this.$filteredAtoms,a)},addItems:function(a,b){var c=this._getAtoms(a);this.$allAtoms=this.$allAtoms.add(c);if(b){b(c)}},insert:function(a,b){this.element.append(a);var c=this;this.addItems(a,function(a){var d=c._filter(a);c._addHideAppended(d);c._sort();c.reLayout();c._revealAppended(d,b)})},appended:function(a,b){var c=this;this.addItems(a,function(a){c._addHideAppended(a);c.layout(a);c._revealAppended(a,b)})},_addHideAppended:function(a){this.$filteredAtoms=this.$filteredAtoms.add(a);a.addClass("no-transition");this._isInserting=true;this.styleQueue.push({$el:a,style:this.options.hiddenStyle})},_revealAppended:function(a,b){var c=this;setTimeout(function(){a.removeClass("no-transition");c.styleQueue.push({$el:a,style:c.options.visibleStyle});c._isInserting=false;c._processStyleQueue(a,b)},10)},reloadItems:function(){this.$allAtoms=this._getAtoms(this.element.children())},remove:function(a,b){var c=this;var d=function(){c.$allAtoms=c.$allAtoms.not(a);a.remove();if(b){b.call(c.element)}};if(a.filter(":not(."+this.options.hiddenClass+")").length){this.styleQueue.push({$el:a,style:this.options.hiddenStyle});this.$filteredAtoms=this.$filteredAtoms.not(a);this._sort();this.reLayout(d)}else{d()}},shuffle:function(a){this.updateSortData(this.$allAtoms);this.options.sortBy="random";this._sort();this.reLayout(a)},destroy:function(){var a=this.usingTransforms;var b=this.options;this.$allAtoms.removeClass(b.hiddenClass+" "+b.itemClass).each(function(){var b=this.style;b.position="";b.top="";b.left="";b.opacity="";if(a){b[i]=""}});var c=this.element[0].style;for(var d in this.originalStyle){c[d]=this.originalStyle[d]}this.element.unbind(".isotope").undelegate("."+b.hiddenClass,"click").removeClass(b.containerClass).removeData("isotope");v.unbind(".isotope")},_masonryReset:function(){this.masonry={};this._getSegments();var a=this.masonry.cols;this.masonry.colYs=[];while(a--){this.masonry.colYs.push(0)}},_masonryLayout:function(a){var c=this,d=c.masonry;a.each(function(){var a=b(this),e=Math.ceil(a.outerWidth(true)/d.columnWidth);e=Math.min(e,d.cols);if(e===1){c._masonryPlaceBrick(a,d.colYs)}else{var f=d.cols+1-e,g=[],h,i;for(i=0;i<f;i++){h=d.colYs.slice(i,i+e);g[i]=Math.max.apply(Math,h)}c._masonryPlaceBrick(a,g)}})},_masonryPlaceBrick:function(a,b){var c=Math.min.apply(Math,b),d=0;for(var e=0,f=b.length;e<f;e++){if(b[e]===c){d=e;break}}var g=this.masonry.columnWidth*d,h=c;this._pushPosition(a,g,h);var i=c+a.outerHeight(true),j=this.masonry.cols+1-f;for(e=0;e<j;e++){this.masonry.colYs[d+e]=i}},_masonryGetContainerSize:function(){var a=Math.max.apply(Math,this.masonry.colYs);return{height:a}},_masonryResizeChanged:function(){return this._checkIfSegmentsChanged()},_fitRowsReset:function(){this.fitRows={x:0,y:0,height:0}},_fitRowsLayout:function(a){var c=this,d=this.element.width(),e=this.fitRows;a.each(function(){var a=b(this),f=a.outerWidth(true),g=a.outerHeight(true);if(e.x!==0&&f+e.x>d){e.x=0;e.y=e.height}c._pushPosition(a,e.x,e.y);e.height=Math.max(e.y+g,e.height);e.x+=f})},_fitRowsGetContainerSize:function(){return{height:this.fitRows.height}},_fitRowsResizeChanged:function(){return true}};b.fn.imagesLoaded=function(a){function h(){a.call(c,d)}function i(a){var c=a.target;if(c.src!==f&&b.inArray(c,g)===-1){g.push(c);if(--e<=0){setTimeout(h);d.unbind(".imagesLoaded",i)}}}var c=this,d=c.find("img").add(c.filter("img")),e=d.length,f="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",g=[];if(!e){h()}d.bind("load.imagesLoaded error.imagesLoaded",i).each(function(){var a=this.src;this.src=f;this.src=a});return c};var w=function(b){if(a.console){a.console.error(b)}};b.fn.isotope=function(a,c){if(typeof a==="string"){var d=Array.prototype.slice.call(arguments,1);this.each(function(){var c=b.data(this,"isotope");if(!c){w("cannot call methods on isotope prior to initialization; "+"attempted to call method '"+a+"'");return}if(!b.isFunction(c[a])||a.charAt(0)==="_"){w("no such method '"+a+"' for isotope instance");return}c[a].apply(c,d)})}else{this.each(function(){var d=b.data(this,"isotope");if(d){d.option(a);d._init(c)}else{b.data(this,"isotope",new b.Isotope(a,this,c))}})}return this}})(window,jQuery)